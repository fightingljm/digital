<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>结算页面</title>
	<link rel="stylesheet" href="css/reset.css">
	<link rel="stylesheet" href="css/jiesuan.css">
</head>
<body>
	<div id="container">
		<header>
			<ul>
				<li>全部商品</li>
				<li>京东大药房</li>
			</ul>
		</header>
		<div class="main">
			<div class="main-top">
				<input type="checkbox" class="all checked">
				<p>全选</p>
				<p>商品</p>
				<ul>
					<li>单价</li>
					<li>数量</li>
					<li>小计</li>
					<li>操作</li>
				</ul>
			</div>
			<div class="store">
				<div class="store-top">
					<input type="checkbox" class="one checked">
					<p>欧塞洛斯照明旗舰店</p>
					<img src="images/jingdomg_38.png" alt="">
					<p>已免运费</p>
				</div>
				<div class="store-mclassdle">
					<img src="images/jingdomg_48.png" alt="">
					<p>活动商品购满3件，即可享受满减</p>
					<a href="#">去凑单＞</a>
				</div>
				<div class="store-bottom">
					<div class="s-b-left">
						<input type="checkbox" class="two checked">
						<img src="images/1.jpg" alt="">
						<p>欧塞洛斯 欧式全铜吊灯客厅卧室<br>餐厅灯具灯饰 H13 J 6头</p>
						<p>颜色：6头</p>
					</div>
					<div class="s-b-right">
						<span>￥</span>
						<span class="yuanjia">459.00</span>
						<ul class="list">
							<li class="jian">-</li>
							<li class="num">1</li>
							<li class="jia">+</li>
						</ul>
						<span>￥</span>
						<span class="money">459.00</span>
						<ul>
							<li class="delete">删除</li>
							<li>到货通知</li>
							<li>移到我的关注</li>
						</ul>
					</div>
				</div>
			</div>
			<div class="store">
				<div class="store-top">
					<input type="checkbox" class="one checked">
					<p>欧塞洛斯照明旗舰店</p>
					<img src="images/jingdomg_38.png" alt="">
					<p>已免运费</p>
				</div>
				<div class="store-middle">
					<img src="images/jingdomg_48.png" alt="">
					<p>活动商品购满3件，即可享受满减</p>
					<a href="#">去凑单＞</a>
				</div>
				<div class="store-bottom">
					<div class="s-b-left">
						<input type="checkbox" class="two checked">
						<img src="images/2.jpg" alt="">
						<p>贝酷(Beiku) 阿狸公仔毛绒玩具布娃娃<br>情侣抱枕玩偶生日情人节圣诞节礼物 圆</p>
						<p>颜色：大号阿狸45cm</p>
					</div>
					<div class="s-b-right">
						<span>￥</span>
						<span class="yuanjia">59.00</span>
						<ul class="list">
							<li class="jian">-</li>
							<li class="num">1</li>
							<li class="jia">+</li>
						</ul>
						<span>￥</span>
						<span class="money">59.00</span>
						<ul>
							<li class="delete">删除</li>
							<li>到货通知</li>
							<li>移到我的关注</li>
						</ul>
					</div>
				</div>
			</div>
			<div class="store">
				<div class="store-top">
					<input type="checkbox" class="one checked">
					<p>欧塞洛斯照明旗舰店</p>
					<img src="images/jingdomg_38.png" alt="">
					<p>已免运费</p>
				</div>
				<div class="store-middle">
					<img src="images/jingdomg_48.png" alt="">
					<p>活动商品购满3件，即可享受满减</p>
					<a href="#">去凑单＞</a>
				</div>
				<div class="store-bottom">
					<div class="s-b-left">
						<input type="checkbox" class="two checked">
						<img src="images/2.jpg" alt="">
						<p>贝酷(Beiku) 阿狸公仔毛绒玩具布娃娃<br>情侣抱枕玩偶生日情人节圣诞节礼物 圆</p>
						<p>颜色：大号阿狸45cm</p>
					</div>
					<div class="s-b-right">
						<span>￥</span>
						<span class="yuanjia">59.00</span>
						<ul class="list">
							<li class="jian">-</li>
							<li class="num">1</li>
							<li class="jia">+</li>
						</ul>
						<span>￥</span>
						<span class="money">59.00</span>
						<ul>
							<li class="delete">删除</li>
							<li>到货通知</li>
							<li>移到我的关注</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<footer>
			<div class="footer-left">
				<input type="checkbox" class="all checked">
				<ul>
					<li>全选</li>
					<li>删除选中的商品</li>
					<li>移到我的关注</li>
					<li>清除下柜商品</li>
				</ul>
			</div>
			<div class="footer-right">
				<p>已选择<span id="selected">0</span>件商品<span>∧</span>
				</p>
				<div>
					<p>总价:
						<span >￥</span>
						<span id="total">0.00</span>
					</p>
					<img src="images/jingdomg_06.png" alt="">
					<br>
					<p>已节省：<span>￥</span>0.00</p>
				</div>
			</div>
			<a href="#">去结算</a>
		</footer>
		<script>
			// function G(name){
			// 	return document.getElementsByClassName(name)
			// }
			// function J(tagName){
			// 	return document.getElementsByTagName(tagName)
			// }
			// function N(id){
			// 	return document.getElementById(id)
			// }
			// function K(){
			// 	for(var n=0;n<G("store-bottom").length;n++){
			// 		G("store-bottom")[n].style.backgroundColor="#fff4e8";
			// 	}
			// }
			// function H(){
			// 	for(var n=0;n<G("store-bottom").length;n++){
			// 		G("store-bottom")[n].style.backgroundColor="white";
			// 	}
			// }
			// //求和
			// function M(){
			// 	var total=0;
			// 	for(var j=0;j<G("money").length;j++){
			// 		total+=parseFloat(G("money")[j].innerHTML);
			// 	}
			// 	N('total').innerHTML=toDecimal2(total);
			// }
			// //强制保留两位小数
			// function toDecimal2(x) {    
		 //        var f = parseFloat(x);    
		 //        if (isNaN(f)) {    
		 //            return false;    
		 //        }    
		 //        var f = Math.round(x*100)/100;    
		 //        var s = f.toString();    
		 //        var rs = s.indexOf('.');    
		 //        if (rs < 0) {    
		 //            rs = s.length;    
		 //            s += '.';    
		 //        }    
		 //        while (s.length <= rs + 2) {    
		 //            s += '0';    
		 //        }    
		 //        return s;    
		 //    }   
		 //    for(var i=0;i<J("input").length;i++){
		 //    	J("input")[i].checked=true;
		 //    } 
			// for(var i=0;i<G("list").length;i++){
			// 	G("jia")[i].index=i;
			// 	G("jian")[i].index=i;
			// 	G("list")[i].onclick=function(){
			// 		var tar = event.target;	
			// 		var ind=tar.index;
			// 		var num=G("num")[ind].innerHTML;
			// 		var yuanjia=G("yuanjia")[ind].innerHTML;			
			// 		if(tar.getAttribute("class")=="jia"){						
			// 			num++;		
			// 		}else if(tar.getAttribute("class")=="jian"){
			// 			if(num>1){
			// 				num--;
			// 			}else{
			// 				num=1;
			// 			}
			// 		}
			// 		G("num")[ind].innerHTML=num;
			// 		var money=parseFloat(yuanjia)*num;
			// 		G("money")[ind].innerHTML=toDecimal2(parseFloat(money));
			// 		G("one")[ind].checked=true;
			// 		G("two")[ind].checked=true;
			// 		M();
			// 	}
			// }			
			// for(var i=0;i<G("all").length;i++){
			// 	G("all")[i].onclick=function(){
			// 		var input=J("input");
			// 		if(this.checked){
			// 			for(var j=0;j<input.length;j++){
			// 				input[j].checked=true;
			// 			}
			// 			K();
			// 			M();
			// 		}else{
			// 			for(var m=0;m<input.length;m++){
			// 				input[m].checked=false;
			// 			}
			// 			H();
			// 			N('total').innerHTML=toDecimal2(0);
			// 		}
			// 	}
			// }
			// for(var i=0;i<G("two").length;i++){
			// 	G("two")[i].index=i;
			// 	G("one")[i].index=i;
			// 	var arr=[];
			// 	G("two")[i].onclick=function(){
			// 		var ind=this.index;
			// 		var xiaoji=parseFloat(G("money")[ind].innerHTML);
			// 		if(this.checked==false){
			// 			for(var j=0;j<G("all").length;j++){
			// 				G("all")[j].checked=false;
			// 			}
			// 			G("one")[ind].checked=false;
			// 			G("store-bottom")[ind].style.backgroundColor="white";
			// 			arr.pop(xiaoji)
			// 			var n=0;
			// 			for(var m in arr){
			// 				n+=arr[m];
			// 			}
			// 			N('total').innerHTML=toDecimal2(n)
			// 		}else{
			// 			arr.push(xiaoji)
			// 			G("one")[ind].checked=true;
			// 			G("store-bottom")[ind].style.backgroundColor="#fff4e8";
			// 			var n=0;
			// 			for(var m in arr){
			// 				n+=arr[m];
			// 			}
			// 			N('total').innerHTML=toDecimal2(n)
			// 		}
					
			// 	}
			// 	G("one")[i].onclick=function(){
			// 		var ind=this.index;
			// 		var xiaoji=parseFloat(G("money")[ind].innerHTML);
			// 		if(this.checked==false){
			// 			for(var j=0;j<G("all").length;j++){
			// 				G("all")[j].checked=false;
			// 			}
			// 			G("two")[ind].checked=false;
			// 			G("store-bottom")[ind].style.backgroundColor="white";
			// 			arr.pop(xiaoji)
			// 			var n=0;
			// 			for(var m in arr){
			// 				n+=arr[m];
			// 			}
			// 			N('total').innerHTML=toDecimal2(n)
			// 		}else{
			// 			arr.push(xiaoji)
			// 			G("two")[ind].checked=true;
			// 			G("store-bottom")[ind].style.backgroundColor="#fff4e8";
			// 			var n=0;
			// 			for(var m in arr){
			// 				n+=arr[m];
			// 			}
			// 			N('total').innerHTML=toDecimal2(n)
			// 		}
					
			// 	}
			// }

			var goods = document.getElementsByClassName('store');
			//合计，已选数目
			function getAllTotal(){
				var price = 0;//合计
				var selected = 0;//已选商品数目
				for(var i = 0;i<goods.length;i++){//遍历商品个数
					if(goods[i].getElementsByClassName("two")[0].checked == true){
						//商品选中
						price+=parseFloat(goods[i].getElementsByClassName("money")[0].innerHTML);
						selected+=parseInt(goods[i].getElementsByClassName("num")[0].innerHTML)
					}
				}
				document.getElementById("total").innerHTML = price.toFixed(2);
				document.getElementById("selected").innerHTML = selected;
			}
			//商品小计
			function getSubTotal(goods){
				var subtotal = 0;
				subtotal = parseFloat(goods.getElementsByClassName("yuanjia")[0].innerHTML) * parseInt(goods.getElementsByClassName("num")[0].innerHTML)
				goods.getElementsByClassName("money")[0].innerHTML = subtotal.toFixed(2);
			}
			//复选框事件
			var inputChecked = document.getElementsByClassName("checked");
			for(var i = 0;i<inputChecked.length;i++){
				inputChecked[i].onclick = function(){
					if(this.className.indexOf("all")>=0){
						for(var j = 0;j<inputChecked.length;j++){
							inputChecked[j].checked = this.checked;
						}
					}else{
						var kaiguan = 1;
						for(var n = 0,len = document.getElementsByClassName("two");n<len.length;n++){
							if(len[n].checked ==false){
								kaiguan = 0;
							}	
						}
						if(kaiguan == 1){
							for(var m = 0,len=document.getElementsByClassName("all");m<len.length;m++){
								document.getElementsByClassName("all")[m].checked = true;
							}
						}
					}
					if(this.checked == false){
						for(var m = 0,len=document.getElementsByClassName("all");m<len.length;m++){
							document.getElementsByClassName("all")[m].checked = false;
						}
					}
					getAllTotal();
				}
			}
			for(var i = 0;i<goods.length;i++){
				goods[i].onclick = function(event){
					var e = event || window.event;
					var tar = e.target || e.srcElement;
					var cls = tar.className;
					var num = parseInt(tar.parentNode.parentNode.getElementsByClassName("num")[0].innerHTML)

					switch (cls){
						case "jia":
						num+=1;tar.parentNode.parentNode.parentNode.getElementsByClassName("two")[0].checked = true;break;
						case "jian":
						if(num>1){
							num-=1;break
						}
						case "delete":
						tar.parentNode.parentNode.parentNode.parentNode.parentNode.removeChild(tar.parentNode.parentNode.parentNode.parentNode)
					}
					tar.parentNode.parentNode.getElementsByClassName("num")[0].innerHTML = num;
					getSubTotal(tar.parentNode.parentNode.parentNode)
					getAllTotal()
				}
			} 
		</script>
	</div>
</body>
</html>